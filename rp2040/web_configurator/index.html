<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RP2040 MIDI Filter Configurator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #f8f8f8; }
    h1 { color: #333; }
    table { border-collapse: collapse; margin-bottom: 2em; }
    th, td { border: 1px solid #bbb; padding: 0.5em 1em; text-align: center; }
    th { background: #e0e0e0; }
    .iface-label { font-weight: bold; }
    .msgtype-label { text-align: right; }
    .channels { margin-bottom: 2em; }
    .channel-checkbox { margin: 0 0.5em; }
    .status { margin-top: 1em; color: #006600; }
    .error { color: #b00; }
    button { padding: 0.5em 1.5em; font-size: 1em; }
    .explain { font-size: 0.95em; color: #555; margin-bottom: 1em; }
    .iface-header { background: #d0eaff; }
    .msgtype-header { background: #ffe0b2; }
    #logbox { width: 100%; height: 180px; background: #222; color: #eee; font-family: monospace; padding: 0.5em; overflow-y: auto; border-radius: 4px; border: 1px solid #888; margin-top: 1.5em; }
    .log-sent { color: #8cf78c; }
    .log-recv { color: #ffd580; }
    .action-buttons { margin-right: 1em; }
  </style>
</head>
<body>
  <h1>RP2040 MIDI Filter Configurator</h1>
  <div class="explain">
    <b>Instructions:</b> Set which MIDI message types are <b>blocked</b> (checked = blocked, unchecked = allowed) for each interface.<br>
    Enable or disable each MIDI channel (checked = enabled).<br>
    Use the buttons below to connect, upload, export, and send configuration.<br>
    <b>Note:</b> "Note (On/Off)" blocks both Note On and Note Off messages.
  </div>
  <form id="configForm">
    <div style="margin-bottom:1em;">
      <button type="button" id="connectBtn" class="action-buttons">Connect</button>
      <button type="button" id="sendBtn" class="action-buttons">Send Config</button>
      <button type="button" id="uploadBtn" class="action-buttons">Upload Config</button>
      <button type="button" id="exportBtn" class="action-buttons">Export Config</button>
      <input type="file" id="fileInput" accept=".json" style="display:none">
    </div>
    <table>
      <thead>
        <tr>
          <th class="iface-header"></th>
          <th class="iface-header">Serial</th>
          <th class="iface-header">USB Device</th>
          <th class="iface-header">USB Host</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="msgtype-header">Note (On/Off)</td>
          <td><input type="checkbox" id="f-0-0"></td>
          <td><input type="checkbox" id="f-1-0"></td>
          <td><input type="checkbox" id="f-2-0"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Poly Aftertouch</td>
          <td><input type="checkbox" id="f-0-1"></td>
          <td><input type="checkbox" id="f-1-1"></td>
          <td><input type="checkbox" id="f-2-1"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Control Change</td>
          <td><input type="checkbox" id="f-0-2"></td>
          <td><input type="checkbox" id="f-1-2"></td>
          <td><input type="checkbox" id="f-2-2"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Program Change</td>
          <td><input type="checkbox" id="f-0-3"></td>
          <td><input type="checkbox" id="f-1-3"></td>
          <td><input type="checkbox" id="f-2-3"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Channel Aftertouch</td>
          <td><input type="checkbox" id="f-0-4"></td>
          <td><input type="checkbox" id="f-1-4"></td>
          <td><input type="checkbox" id="f-2-4"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Pitch Bend</td>
          <td><input type="checkbox" id="f-0-5"></td>
          <td><input type="checkbox" id="f-1-5"></td>
          <td><input type="checkbox" id="f-2-5"></td>
        </tr>
        <tr>
          <td class="msgtype-header">SysEx</td>
          <td><input type="checkbox" id="f-0-6"></td>
          <td><input type="checkbox" id="f-1-6"></td>
          <td><input type="checkbox" id="f-2-6"></td>
        </tr>
        <tr>
          <td class="msgtype-header">Realtime</td>
          <td><input type="checkbox" id="f-0-7"></td>
          <td><input type="checkbox" id="f-1-7"></td>
          <td><input type="checkbox" id="f-2-7"></td>
        </tr>
      </tbody>
    </table>
    <div class="channels">
      <b>MIDI Channels (1-16):</b><br>
      <span id="channels">
        <!-- Channel checkboxes will be generated by JS -->
      </span>
    </div>
    <div class="status" id="status"></div>
    <div>
      <b>Serial Log:</b>
      <pre id="logbox"></pre>
    </div>
  </form>
  <script>
    // Generate channel checkboxes
    const channelsDiv = document.getElementById('channels');
    for (let i = 0; i < 16; i++) {
      const label = document.createElement('label');
      label.innerHTML = `<input type="checkbox" class="channel-checkbox" id="ch-${i}" checked> ${i+1}`;
      channelsDiv.appendChild(label);
    }
  </script>
  <script type="module" src="./dist/app.js"></script>
</body>
</html>
